// JavaScript Document
$(document).ready(function(){
	
	//Navbar stickiness
	//Static
	var scroll = $(window).scrollTop();
	if (scroll > 100) {
		$("#navbar").addClass("is-scrolling");
	}
	//Scrolling
	  $(window).scroll(function(){
		var scroll = $(window).scrollTop();
		  if (scroll > 100) {
			$("#navbar").addClass("is-scrolling");
		  }

		  else{
			  $("#navbar").removeClass("is-scrolling");  	
		  }
	  });
      
	//
	$("#banner").click(function(){
			ga('send', 'event', 'Navigation', 'Plastics Logo Banner');
			URL = $(this).data('url');
			window.open(URL, '_self');
	});
	$("#logo").click(function(){
			ga('send', 'event', 'Navigation', 'This Is Plastics Logo');
			URL = $(this).data('url');
			window.open(URL, '_self');
	});
	//control site navigation visibility
	$("#navbar #menu-btn").click(function(){
		$("#navbar #menu-btn").toggleClass("close");
		$("#navbar .menu .quick-links").toggleClass("show");
		$("#navbar").toggleClass("open");
		//due to css complexities, show or hide the search bg here
		if($("#navbar").hasClass("open")){
			ga('send', 'event', 'Navigation', 'Hamburger Menu', 'Open');
		}else{
			//now closed
			ga('send', 'event', 'Navigation', 'Hamburger Menu', 'Close');
		}
	});
	//Click & Open up the search bar
	$("#navbar #search-btn").on("click",function (e) {
			ga('send', 'event', 'Navigation', 'Desktop Search Button');
			$("#nav-search-block").addClass("show");
			$("#nav-search").addClass("show");
			e.stopPropagation();
			//causes a scroll?
			$("#nav_search_input").focus();
		});
//
		$(document).on("click", function (e) {
			//When the user clicks outside the active element
			//Navbar Search
			if ( $(e.target).is("#nav-search ") === false && $(e.target).is("#nav-search #nav_search_input") === false ) {
				$("#nav-search").removeClass("show");
				$("#nav-search-block").removeClass("show");
			}
			
			//Questions search
			if ( $(e.target).is("#questions-search") === false && $(e.target).is("#questions-search #questions_search_input") === false ) {
				$("#questions-search").removeClass("show");
				$("#questions-search-block").removeClass("show");
			}
			
			if ( $(e.target).is("#navbar #menu-btn, #mobile-search-btn") === false && $(e.target).is("#navbar.open, #navbar .menu .quick-links,  #mobile_search_input") === false ) {
				$("#navbar #menu-btn").removeClass("close");
				$("#navbar .menu .quick-links").removeClass("show");
				$("#navbar").removeClass("open");
                
			}
			
			 
		});

	$("#navbar #mobile-search-btn").click(function(){
		ga('send', 'event', 'Navigation', 'Mobile Search Button');
		$("#navbar #menu-btn").click();
			//causes a scroll?
		 $("#mobile_search_input").focus();
	});
	 
	
	//category clicks
	if ($("#navbar .menu .categories li").length){
		$("#navbar .menu .categories li").click(function(){
			ga('send', 'event', 'Navigation', 'Hambuger Menu', 'Category', $(this).attr('class'));
			URL = $(this).data('url');
			window.open(URL, '_self');
		});
	}
	
	//submit searches
	$("#nav-search #nav_search_btn").click(function(){
		if($("#nav_search_input").val().length>0){
			ga('send', 'event', 'Navigation', 'Search', 'Search Submit');
			URL = "/search/"+$("#nav_search_input").val();
			window.open(URL, '_self');
		}
	});
	
	$("#questions-search #questions_search_btn").click(function(){
		if($("#questions_search_input").val().length>0){
			ga('send', 'event', 'Questions', 'Search', 'Search Submit');
			URL = "/search/"+$("#questions_search_input").val();
			window.open(URL, '_self');
		}
	});
	
	$("#mobile-search #mobile_search_btn").click(function(){
		if($("#mobile_search_input").val().length>0){
			ga('send', 'event', 'Navigation', 'Search', 'Mobile Search Submit');
			URL = "/search/"+$("#mobile_search_input").val();
			window.open(URL, '_self');
		}
	});
	
	
	if($("#home_search").length){
		$("#home_search #home_search_btn").click(function(){
			if($("#home_search_input").val().length>0){
				ga('send', 'event', 'Search', 'Home Search Submit');
				URL = "/search/"+$("#home_search_input").val();
				window.open(URL, '_self');
			}
		});
	}
	
	if($("#questions_search").length){
		$("#questions_search #questions_search_btn").click(function(){
			if($("#questions_search_input").val().length>0){
				ga('send', 'event', 'Search', 'Still have questions Submit');
				URL = "/search/"+$("#questions_search_input").val();
				window.open(URL, '_self');
			}
		});
	}
	
	
	$('#nav_search_input').keypress(function(event){
	  if(event.keyCode == 13){
		$("#nav-search #nav_search_btn").click();
	  }
	});
	
	
	$('#mobile_search_input').keypress(function(event){
	  if(event.keyCode == 13){
		$("#mobile-search #mobile_search_btn").click();
	  }
	});

	$('#questions_search_input').keypress(function(event){
	  if(event.keyCode == 13){
		$("#questions-search #questions_search_btn").click();
	  }
	});
	
	$('#home_search_input').keypress(function(event){
	  if(event.keyCode == 13){
		$("#home_search #home_search_btn").click();
	  }
	});
	//
	//tracking ONLY
	$(".bottom-container .menu-secondary-container ul#menu-secondary li a").click(function(){
		Name = $(this).text();
		ga('send', 'event', 'Navigation', 'Hambuger Menu', 'Secondary Menu', Name);
	});
	$(".menu-social-container ul#menu-social li a").click(function(){
		Name = $(this).text();
		ga('send', 'event', 'Navigation', 'Hambuger Menu', 'Social Menu', Name);
	});
	
	//
});

//
//sticky nav only on home
function InitStickySearch(){
	
	
	var navWaypoint = $('div#home_hero div#home_content div#home_search').waypoint(function(direction) {
		if($("#navbar").hasClass("open")){
			
		}else{
			if(direction == "down"){
				//scrolling down, attach
				$("#navbar").addClass("search");
				$("#navbar #nav-search-bg").fadeIn(250, 'easeInOutCubic');
				$("#navbar #nav-search").fadeIn(250, 'easeInOutCubic');
				$("#home_content").fadeOut(250, 'easeInOutCubic');
			}else{
				//scrolling up, unattach
				$("#navbar").removeClass("search");
				$("#navbar #nav-search-bg").fadeOut(250, 'easeInOutCubic');
				$("#navbar #nav-search").fadeOut(250, 'easeInOutCubic');
				$("#home_content").fadeIn(250, 'easeInOutCubic');
			}
		}
	}, {
	  offset: 50
	});
	//
}