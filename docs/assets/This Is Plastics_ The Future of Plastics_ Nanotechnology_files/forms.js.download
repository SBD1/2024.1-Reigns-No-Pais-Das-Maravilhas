// JavaScript Document
$(document).ready(function(){
    $('input[type="tel"]').mask('(000) 000-0000');
    $('input[name="zip"]').mask('00000');
    $('input[name="first-name"]').mask('Z',{translation: {'Z': {pattern: /[a-zA-Z]/, recursive: true}}});
    $('input[name="last-name"]').mask('Z',{translation: {'Z': {pattern: /[a-zA-Z]/, recursive: true}}});
    
    
	//
});


// JavaScript Document

//jvcf7_loading_url= "'.plugins_url('contact-form-7/images/ajax-loader.gif').'";
//jvcf7_invalid_field_design = "'.$optionValues["jvcf7_invalid_field_design"].'";
//jvcf7_show_label_error = "'.$optionValues["jvcf7_show_label_error"].'";

//wpcf7:invalid
//wpcf7:spam
//wpcf7:mailsent
//wpcf7:mailfailed
//wpcf7:submit

$(document).ready(function(){
	var entities = {
	  'amp': '&',
	  'apos': '\'',
	  '#x27': '\'',
	  '#x2F': '/',
	  '#39': '\'',
	  '#47': '/',
	  'lt': '<',
	  'gt': '>',
	  'nbsp': ' ',
	  'quot': '"'
	}

	function decodeHTMLEntities (text) {
	  return text.replace(/&([^;]+);/gm, function (match, entity) {
		return entities[entity] || match
	  })
	}
	//Populate form
	var Queries = location.search;
	if(Queries){
		var feedback = Queries.split("=");
		$("#feedback").val( decodeURIComponent(feedback[1]));	
	}
	
	
	//
	$("#form_submit").click(function(){
		PreCF7Submit();
	});
	
	$("input[name='first-name']").change(function(){
		PreCF7Validate("input[name='first-name']");
	});
	$("input[name='last-name']").change(function(){
		PreCF7Validate("input[name='last-name']");
	});
    $("input[name='email']").change(function(){
		PreCF7ValidateEmail("input[name='email']");
	});
	$("input[name='phone']").change(function(){
		PreCF7Validate("input[name='phone']");
	});
    $("input[name='company']").change(function(){
		PreCF7Validate("input[name='company']");
	});
    $("input[name='address1']").change(function(){
		PreCF7Validate("input[name='address1']");
	}); 
    $("input[name='address2']").change(function(){
		PreCF7Validate("input[name='address2']");
	});
    $("input[name='companyAddress']").change(function(){
		PreCF7Validate("input[name='companyAddress']");
	});
	
	$("select[name='city']").change(function(){
		PreCF7Validate("select[name='city']");
	});
    $("select[name='state']").change(function(){ 
		PreCF7Validate("select[name='state']");
	});
    $("input[name='zip']").change(function(){
		PreCF7Validate("input[name='zip']");
	});
    $("select[name='feedbackType']").change(function(){
		PreCF7Validate("select[name='feedbackType']");
	});
	$("textarea[name='feedback']").change(function(){
		PreCF7Validate("textarea[name='feedback']");
	});
	
	$(".wpcf7").on("wpcf7:mailsent", function(){
		HideWPCF7Form();
	});
	
	$("input.phoneUS").mask("(999) 999-9999");
	
	//
	var interstitialEmail = (Cookies.get('inters_email')) ? Cookies.get('inters_email') : '';
	var interstitialZip = (Cookies.get('inters_zip')) ? Cookies.get('inters_zip') : '';
	
	$("#emailaddress").val(interstitialEmail);
	$("#Zipcode").val(interstitialZip);
});

//do a client-side validation before CF7 submit
function PreCF7Submit() {
 //
	PreCF7Validate("input[name='first-name']");
	PreCF7Validate("input[name='last-name']");
    PreCF7ValidateEmail("input[name='email']");
	PreCF7Validate("input[name='phone']");
    PreCF7Validate("input[name='company']");
    PreCF7Validate("input[name='address1']");
    PreCF7Validate("input[name='address2']");
    PreCF7Validate("input[name='companyAddress']");
    PreCF7Validate("select[name='city']");
    PreCF7Validate("select[name='state']");
    PreCF7Validate("input[name='zip']");
    PreCF7Validate("select[name='feedbackType']");
    PreCF7Validate("textarea[name='feedback']"); 
	
	if($('.wpcf7').find('.wpcf7-not-valid').length != 0){
		//console.log ("errors");	
        
	}else{
		
//		//Send Form data
//			$.ajax({
//			url: '/acton/?process=question',
//			type:'POST',
//			data: {
//				firstname: $( "#INTheader1 input#firstname" ).val(),
//				lastname: $( "#INTheader1 input#lastname" ).val(),
//				emailaddress: $( "#INTheader1 input#emailaddress" ).val(),
//				phone: $( "#INTheader1 input#phone" ).val(),
//				address: $( "#INTheader1 input#address" ).val(),
//				organization: $( "#INTheader1 input#organization" ).val(),
//				state: $( "#INTheader1 input#state" ).val(),
//				city: $( "#INTheader1 input#city" ).val(),
//				zip: $( "#INTheader1 input#Zipcode" ).val(),
//				feedbackType: $( "#INTheader1 input#feedbackType" ).val(),
//				feedback : $( "#INTheader1 input#feedback" ).val() 
//			},
//			success:function(data) { // AJAX REQUEST RESULTS
//				console.log("We will get back to you soon...");
//			},
//			error: function(errorThrown){
//				//console.log(errorThrown);
//			}
//		});
		//InterSuccessUI();
	} 
 //
}

function PreCF7Validate(input){
	if( !$(input).val() ){
		$(input).addClass("wpcf7-not-valid");
	}else{
		$(input).removeClass("wpcf7-not-valid");
	} 
}

function PreCF7ValidateEmail(input){
	if( !$(input).val() ){
		$(input).addClass("wpcf7-not-valid");
	}else{
		if( validateEmail($(input).val())  == false ){
			$(input).addClass("wpcf7-not-valid");
		}else{
			$(input).removeClass("wpcf7-not-valid");
		}
	}
}


function HideWPCF7Form(){
	//hide the form, but leave the thank you message
	$(".recaptcha").hide();
	$(".wpcf7 p").slideUp(500, 'easeInOutCubic');
	$(".rc-anchor").hide();
	$("p.note").hide();
	$(".wpcf7 iframe").hide();
}

//simple regex email validation
function validateEmail(email) 
{
    var re = /\S+@\S+\.\S+/;
    return re.test(email);
}


